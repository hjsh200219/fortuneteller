# 사주 운세 MCP 서버 - Product Requirements Document

## 1. 프로젝트 개요

### 1.1 목적
AI 어시스턴트(Claude 등)가 사용자의 생년월일시 정보를 기반으로 전통 사주팔자 분석과 운세를 제공할 수 있는 MCP(Model Context Protocol) 서버를 개발합니다.

### 1.2 배경
- 사주팔자는 한국 전통 운세 분석 방법으로 생년월일시를 기반으로 운명을 예측
- MCP를 통해 AI 어시스턴트가 구조화된 사주 데이터를 처리하고 해석 제공
- 사용자에게 개인화된 운세 상담 서비스 제공

## 2. 핵심 기능

### 2.1 사주팔자 계산
- **입력**: 생년월일시 (양력/음력), 성별, 출생 시간
- **출력**: 
  - 천간(天干) 8자: 연주(年柱), 월주(月柱), 일주(日柱), 시주(時柱)
  - 지지(地支) 8자
  - 오행(五行) 분석: 목(木), 화(火), 토(土), 금(金), 수(水)
  - 십성(十星): 비견, 겁재, 식신, 상관, 편재, 정재, 편관, 정관, 편인, 정인

### 2.2 운세 분석
- **기본 성격 분석**: 사주팔자 기반 성격 특성
- **연도별 운세**: 대운(大運), 세운(歲運) 분석
- **월별/일별 운세**: 상세 운세 제공
- **궁합 분석**: 두 사람의 사주 비교 및 궁합도 계산
- **직업운/재물운/건강운**: 분야별 운세 분석

### 2.3 음양력 변환
- 양력 → 음력 변환
- 음력 → 양력 변환
- 윤달 처리

### 2.4 사주 해석
- AI 기반 종합 운세 해석
- 긍정적/부정적 요소 분석
- 조언 및 개선 방향 제시

## 3. MCP 도구(Tools) 정의

### 3.1 `calculate_saju`
```json
{
  "name": "calculate_saju",
  "description": "생년월일시로부터 사주팔자를 계산합니다",
  "parameters": {
    "birthDate": "생년월일 (YYYY-MM-DD)",
    "birthTime": "출생 시간 (HH:MM)",
    "calendar": "양력/음력 구분 (solar/lunar)",
    "isLeapMonth": "음력 윤달 여부 (boolean)",
    "gender": "성별 (male/female)"
  }
}
```

### 3.2 `analyze_fortune`
```json
{
  "name": "analyze_fortune",
  "description": "사주팔자를 기반으로 운세를 분석합니다",
  "parameters": {
    "sajuData": "calculate_saju 결과",
    "analysisType": "분석 유형 (general/career/wealth/health/love)",
    "targetDate": "운세를 볼 날짜 (YYYY-MM-DD, optional)"
  }
}
```

### 3.3 `check_compatibility`
```json
{
  "name": "check_compatibility",
  "description": "두 사람의 궁합을 분석합니다",
  "parameters": {
    "person1": "첫 번째 사람의 사주 데이터",
    "person2": "두 번째 사람의 사주 데이터"
  }
}
```

### 3.4 `convert_calendar`
```json
{
  "name": "convert_calendar",
  "description": "양력과 음력을 변환합니다",
  "parameters": {
    "date": "날짜 (YYYY-MM-DD)",
    "fromCalendar": "원본 달력 (solar/lunar)",
    "toCalendar": "변환할 달력 (solar/lunar)"
  }
}
```

### 3.5 `get_daily_fortune`
```json
{
  "name": "get_daily_fortune",
  "description": "특정 날짜의 일일 운세를 제공합니다",
  "parameters": {
    "sajuData": "사용자의 사주 데이터",
    "date": "운세를 볼 날짜 (YYYY-MM-DD)"
  }
}
```

## 4. 기술 스택

### 4.1 백엔드
- **언어**: TypeScript / Node.js
- **MCP SDK**: @modelcontextprotocol/sdk
- **사주 계산 라이브러리**: 
  - 음양오행 계산 로직
  - 천간지지 변환
  - 절입 시간 계산

### 4.2 데이터
- **천간지지 데이터**: JSON 파일
- **24절기 데이터**: 1900년~2100년 절기 시간
- **오행 상생상극 관계**: 정적 데이터
- **운세 해석 템플릿**: AI 프롬프트 템플릿

### 4.3 외부 API (선택)
- 음양력 변환 API (한국천문연구원)
- 시간대 변환 (시차 보정)

## 5. 사용자 시나리오

### 5.1 기본 사주 조회
```
사용자: "1990년 3월 15일 오전 10시 30분생 남자의 사주를 알려줘"
AI: [calculate_saju 호출]
    "사주팔자 계산 결과:
     년주: 경오(庚午), 월주: 기묘(己卯), 일주: 신해(辛亥), 시주: 계사(癸巳)
     오행 분석: 금3, 수2, 목1, 화2, 토1
     ..."
```

### 5.2 운세 분석
```
사용자: "올해 재물운은 어때?"
AI: [analyze_fortune 호출 with analysisType='wealth']
    "2025년 재물운 분석:
     전반적으로 안정적인 한 해입니다. 
     상반기에는 저축에 집중하고, 하반기에는 투자 기회가..."
```

### 5.3 궁합 보기
```
사용자: "나랑 1992년 5월 20일생 여자랑 궁합 봐줘"
AI: [check_compatibility 호출]
    "궁합 분석 결과:
     궁합도: 75/100
     장점: 서로 보완적인 성격, 소통이 원활
     주의점: 금전 관련 의견 차이 가능..."
```

## 6. 요구사항

### 6.1 기능적 요구사항
- ✅ 정확한 사주팔자 계산 (천간지지 변환)
- ✅ 음양력 변환 지원 (1900-2100년)
- ✅ 다양한 운세 분석 (성격, 직업, 재물, 건강, 애정)
- ✅ 궁합 분석 기능
- ✅ 일일/월간/연간 운세 제공
- ✅ 한국어 지원 (주 사용 언어)

### 6.2 비기능적 요구사항
- **성능**: 각 도구 호출당 3초 이내 응답
- **정확성**: 사주 계산 정확도 99% 이상
- **확장성**: 새로운 분석 유형 추가 용이
- **유지보수성**: 명확한 코드 구조 및 문서화

### 6.3 데이터 보안
- 사용자 생년월일 정보는 메모리에만 보관
- 영구 저장 없음 (프라이버시 보호)
- 요청 로그에 개인정보 제외

## 7. 제약사항

### 7.1 기술적 제약
- MCP 프로토콜 표준 준수
- Node.js 18 이상 필요
- 인터넷 연결 필요 (외부 API 사용 시)

### 7.2 범위 제약
- 초기 버전: 한국 사주팔자에 집중
- 타로, 별자리 등 다른 운세는 미지원
- 실시간 점술가 상담 기능 미포함

### 7.3 책임 제한
- 운세는 참고용이며 의학적/법률적 조언 아님
- 중요한 결정은 전문가와 상담 권장
- 면책 조항 명시

## 8. 개발 단계

### Phase 1: 기초 구축 (1-2주)
- MCP 서버 기본 구조 설정
- 사주팔자 계산 로직 구현
- 음양력 변환 기능

### Phase 2: 핵심 기능 (2-3주)
- 운세 분석 도구 구현
- 궁합 분석 기능
- AI 해석 프롬프트 개발

### Phase 3: 고도화 (1-2주)
- 일일/월간 운세 기능
- 에러 처리 및 예외 케이스
- 테스트 및 문서화

### Phase 4: 출시 준비 (1주)
- 통합 테스트
- 성능 최적화
- README 및 사용 가이드 작성

## 9. 성공 지표

- ✅ 모든 MCP 도구가 정상 작동
- ✅ 사주 계산 정확도 검증 완료
- ✅ AI 어시스턴트와 원활한 통합
- ✅ 사용자 시나리오 테스트 통과
- ✅ 문서화 완료

## 10. 향후 확장 계획

- 타로 카드 추가
- 별자리 운세
- 토정비결
- 꿈 해몽
- 다국어 지원 (영어, 중국어)
- 웹 UI 제공
- 모바일 앱 연동

---

**문서 버전**: 1.0  
**작성일**: 2025-10-01  
**최종 수정일**: 2025-10-01

